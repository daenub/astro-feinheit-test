---
import Layout from '../../layouts/Layout.astro';
import Region from '../../components/cms/Region.astro';

export async function getStaticPaths() {
    const res = await fetch("https://feinheit.ch/blog/", {
        headers: {
            "Accept": "application/json"
        }
    })

    const data = await res.json()

    return data.articles.map((article) => {
        const slug = article.url.split("/")[2]

        return {
            params: {slug},
            props: {articleUrl: article.url}
        }
    })
}
const { articleUrl } = Astro.props;

const res = await fetch("https://feinheit.ch" + articleUrl, {
    headers: {
        "Accept": "application/json"
    }
})

const article = await res.json()

article.regions.main.map(c => c.type).forEach(t => console.log(t))
---

<Layout title={article.title}>
    <div class="article">
		<h1 class="title">{article.title}</h1>
        <Region region={article.regions.main} />
    </div>
</Layout>

<style>
.title {
    margin-bottom: 3rem;
    line-height: 1.3;
}

.article {
    margin-top: 3rem;
}
</style>